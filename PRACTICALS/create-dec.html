<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
</head>
<body>
    <div class="container text-center">
        <button onclick="gotoMainpage()" class="btn btn-primary">GO TO Main Page</button>
        <h2>CREATE & EDIT PAGE</h2>

        <div id="userDetails" class="container">
            <form>
                <div class="mb-3">
                    <label for="id" class="form-label">ID</label>
                    <input type="text" class="form-control" disabled>
                  </div>
                  <div class="mb-3">
                    <label for="name" class="form-label">Name</label>
                    <input type="text" class="form-control" id="name">
                  </div>
                  <div class="mb-3">
                    <label for="username" class="form-label">UserName</label>
                    <input type="text" class="form-control" id="username">
                  </div>
                <div class="mb-3">
                  <label for="email" class="form-label">Email address</label>
                  <input type="email" class="form-control" id="exampleInputEmail1">
                </div>
                <div class="mb-3">
                  <label for="phone" class="form-label">phone</label>
                  <input type="tel" class="form-control" id="phone">
                  <div class="mb-3">
                    <label for="website" class="form-label">website</label>
                    <input type="website" class="form-control" id="website">
                  </div>
                </div>
                <button type="button" class="btn btn-primary" onclick="updateUser()">Update</button>
              </form>
        </div>
    </div>
    <script>
        var mainUser = {}
        function gotoMainpage(){
            window.location.href = "BOM_dec.html"
        }
        var url = window.location.href;
        console.log(url)
        var id = url.substr(url.lastIndexOf("?")+1)
        console.log(id)

        fetch("http://localhost:3000/users/"+id)
        .then((response)=>{
             return response.json()
            })
        .then((user)=>{
            mainUser = user
            for(a in user){
                if(a !== "address" && a !== "company"){
                    document.getElementById(a).value = user[a]
                }
            }
        })
        function gotoMainpage(){
            window.location.href="BOM_dec.html"
        }

        function updateUser(){

            // if(id){
            //     // callUpdate functio
            //     console.log("Update User Called")
            // }else{
            //     console.log("Create user Called")
            // }
            var newUser={...mainUser}
            for(a in newUser){
                if(a !== "company" && a !== "address"){
                    newUser[a] = document.getElementById(a).value
                }
            }

            fetch("http://localhost:3000/users/"+id,{
                method:"PUT",
                headers:{
                    "content-Type" : "application/json"
                },
                body:JSON.stringify(newUser)
            }).then((response)=>{
                return response.json()
            }).then(()=>{
                window.location.href="BOM_dec.html"
            })
            console.log(newUser)
        }
        
        // function captureUser(){
        //     var newUser={...mainUser}
        //     for(a in newUser){
        //         if(a !== "company" && a!== "address"){
        //             newUser[a] = document.getElementById(a).valuue
        //         }
            
        //     }

        //     return newUser
        // }
    </script>
</body>
</html>